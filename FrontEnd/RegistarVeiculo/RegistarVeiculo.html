<!DOCTYPE html>
<html lang="en">
    <head>
        <title>RegistarVeiculo</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
         <!--JQUERY-->
         <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.2/jquery.min.js" integrity="sha512-tWHlutFnuG0C6nQRlpvrEhE4QpkG1nn2MOUMWmUeRePl4e3Aki0VB6W1v3oLjFtd0hVOtRQ9PHpSfN6u6/QXkQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
         <!--BootStrap 5.2-->
         <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
         <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
        <link rel="stylesheet" href="style.css"> 
    </head>
    <body class="bg-primary">
        <header class="p-3 bg-primary">
            <div class="row align-items-center">
                <div class="col-2">
                    <a style="cursor:pointer"> 
                        <i class="fa fa-2xl fa-arrow-left text-white"></i>    
                    </a>              
                </div>
                <div class="col-8"> 
                    <div class="m-2 d-flex justify-content-center ">
                        <h2 class="my-1 fw-bold text-white">Registar Veiculo</h2>
                    </div>
                </div>
                <div class="col-1"></div>
            </div>
        </header>
        <div style="margin-top: 10%; width: 90%" class="container bg-light rounded-5 p-3 shadow-lg">
            <div class="container w-100 col-6">
                <div class="my-4">Matricula
                    <div class="input-group my-1" id="formPlate">
                        <span class="input-group-text bg-secondary" id="basic-addon1">                    
                            <i class="fa fa-car text-white"></i>
                        </span>
                        <input type="text" class="form-control" 
                                placeholder="ex: 54-DN-75" id="vehiclePlate" maxlength="8" />
                    </div>
                </div>
                <div class="my-4">Cor
                    <div class="input-group my-1">
                        <span class="input-group-text bg-secondary" id="basic-addon1">                    
                            <i class="fa fa-fill-drip text-white"></i>
                        </span>
                        <input type="text" class="form-control"
                                placeholder="ex: Vermelho" id="vehicleColor" maxlength="20" />    
                    </div>
                </div>
                <div class="my-4 ">Disponiveis Lugares
                    <div class="input-group my-1">
                    <label class="input-group-text bg-secondary" for="inputGroupSelect01">
                        <i class="fa fa-people-group text-white"></i>
                    </label>
                    <select class="form-select" id="availableSits">
                        <option disabled selected value="0">Selecinar número de lugares</option>
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                    </select>
                    </div>  
                </div>

                <div class="my-4">Especificações
                    <div class="input-group my-1">
                        <span class="input-group-text bg-secondary" id="basic-addon1">                    
                            <i class="fa fa-file-pen text-white"></i>
                        </span>
                            <textarea class="form-control" id="vehicleSpecs" rows="6" 
                            placeholder="ex: O veiculo é uma mota com cerca de 75km" maxlength="200"></textarea>
                    </div>
                </div>
            </div>
            <div class="container">
                <div class="row justify-content-center ">
                    <button class="btn btn-outline-secondary col-6 my-5" type="submit" id="submitBtn">Guardar Registo</button>
                </div>
            </div>
        </div>
        <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        <script>
            var userPlate = document.getElementById("vehiclePlate");
            var color = document.getElementById("vehicleColor");
            var sits = document.getElementById("availableSits");
            var specs = document.getElementById("vehicleSpecs");
            var btn = document.getElementById("submitBtn");
            var data = [], vehicle = new Array();

            $( document ).ready(
                plateFunction,
                btn.addEventListener("click", clicarBotao)
            );

            function clicarBotao(){
                data = JSON.parse(localStorage.getItem('users'))[0];
                console.log(data.idUser);

                vehicle.push({
                    "idUser" : data.idUser,
                    "vehiclePlate" : userPlate.value,
                    "vehicleColor" : color.value,
                    "availableSits" : sits.value,
                    "vehicleSpecs" : specs.value
                });
                console.log(vehicle);

                userPlate.value = '';
                color.value = '';
                sits.value = 0;
                specs.value = '';
                localStorage.setItem('userVehicles', JSON.stringify(vehicle));
            }

            function plateFunction($, undefined) {
                "use strict";
                $(function() {
                    var $form = $( "#formPlate" );
                    var $input = $form.find( "input" );

                    $input.on( "keyup", function( event ) {
                        // When user select text in the document, also abort.
                        var selection = window.getSelection().toString();
                        if ( selection !== '' ) {
                            return;
                        }
                        
                        var $this = $(this);
                        var input = $this.val();
                        input = input.replace(/[\W\s\._\-]+/g, '');
                            
                        var split = 2;
                        var chunk = [];

                        for (var i = 0, len = input.length; i < len; i += split) {
                            split = ( i >= 0 && i <= 2 ) ? 2 : 2;
                            chunk.push( input.substr( i, split ) );
                        }
                        $this.val(function() {
                            return chunk.join("-").toUpperCase();
                        });
                    }); 
                   
                });
                
            }
        </script>
    </body>
</html>
