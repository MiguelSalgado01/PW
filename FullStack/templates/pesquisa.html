<!DOCTYPE html>

<html lang="eng">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pesquisar Boleia</title>
        <!--JQUERY-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.2/jquery.js" integrity="sha512-NMtENEqUQ8zHZWjwLg6/1FmcTWwRS2T5f487CCbQB3pQwouZfbrQfylryimT3XvQnpE7ctEKoZgQOAkWkCW/vg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.11.6/umd/popper.min.js" integrity="sha512-6UofPqm0QupIL0kzS/UIzekR73/luZdC6i/kXDbWnLOJoqwklBK6519iUnShaYceJ0y4FaiPtX/hRnV/X/xlUQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.js" integrity="sha512-WNLxfP/8cVYL9sj8Jnp6et0BkubLP31jhTG9vhL/F5uEZmg5wEzKoXp1kJslzPQWwPT1eyMiSxlKCgzHLOTOTQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

        
        <!--BootStrap 5.2-->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <script defer src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
        
        <!--Custom Style-->
        <link rel="stylesheet" href="{{url_for('static', filename='css/boleia.css')}}"> 
        
        <!--Icons-->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
        
        <!--DataTables-->
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/1.13.1/js/jquery.dataTables.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.1/css/jquery.dataTables.css">
        
        
        <!--Responsive DataTable-->
        <script type="text/javascript" charset="utf8" src="https://cdn.datatables.net/responsive/2.4.0/js/dataTables.responsive.min.js"></script>
        <!--<link href="https://cdn.datatables.net/responsive/2.4.0/css/responsive.dataTables.min.css"> errada-->
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/responsive/2.1.1/css/responsive.bootstrap.min.css" />

        <!--Filters Datatable-->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables.net-searchpanes/2.1.0/dataTables.searchPanes.min.js" integrity="sha512-4TzK0SllupG0z0DsYE/nqnAUzayYEk/+HynkBpT2W7zNzIKdOUBs3sVMkHRCpKf8V7D6jUGwRSs3278TCXmeUw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables.net-select/1.5.0/dataTables.select.min.js" integrity="sha512-N4LdjsNox6lPb6dwOVZHGmBK6m/fGoVwyGTCpK/AnyHk/nkwMQgAsYmKHTpaLEV1NpR8FtsSG2IScfJq00o4Jw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/datatables-buttons/2.3.2/js/dataTables.buttons.min.js" integrity="sha512-eIcHgB6taj4el2IrrHakW8xPCABRpLT9Z6uBYwnE2pXabGuAcEtgvuFd1wGifKZTwivBDe2SKKQyJXS1LTFpHA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/datatables.net-select-dt/1.5.0/select.dataTables.css" integrity="sha512-plFB97rXXBK14o75yF073iBlhIHCNUXY2tkWOPjvetlfEdI30b8hC98P+R3etqlKLQJ9iMxibXdvPZDFmJRXSQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/datatables.net-searchpanes-bs/2.1.0/searchPanes.bootstrap.css" integrity="sha512-pmxYxFWYY+pRTOu7VjuMPc5uxnqOa6e0P7mhHd7MvOoJtdIhB86906lbxdHzNrszts2e6S6FcObJ88x/WQoMxQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/datatables.net-buttons-bs/2.3.2/buttons.bootstrap.css" integrity="sha512-NxcLfnVOfcJV8W+pQ0yuRhxKHqn4i/IkQmy53keDZ/CbeaW/n2Z1izM8LHQB/U+G9en1iwqZKxXPSoBssub1pQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        
    </head>
    <body>
        <header class="p-3 mb-5 bg-primary" id="mrs">
            <form action="" method="POST">
            {{goBack.hidden_tag()}}
                <div class="row align-items-center" >
                    <div class="col-2">
                        <a style="cursor:pointer">
                            <button class="fa fa-2xl fa-arrow-left text-white" type="submit" name="goBack" value="EcraPrevio" style=" background-color: transparent; border: none;"></button> 
                        </a>           
                    </div>
                    <div class="col-8" > 
                        <div class="m-2 d-flex justify-content-center " >
                            <h2 class="my-1 fw-bold text-white">Pesquisar Boleia</h2>
                        </div>
                    </div>
                </div>
            </form>
        </header>
        <!--Table-->    
        <div class="container-md" id="table">
            <div class="table-responsive"> 
                <table class="table display nowrap" id="tabela">
                    <thead class="bg-primary text-white">
                        <tr>
                            <td>id</td>
                            <td>user</td>
                            <td>vehicle</td>
                            <td>date</td>
                            <td>scheduled_time</td>
                            <td>destiny</td>
                            <td>origin</td>
                            <td>seats</td>
                            <td>Especificações de Veiculo</td>
                            <th class="all">Selecionar</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for ride in getRideData %}
                            {% if ride[7]!=0  %}
                                <tr>
                                    <td>{{ride[0]}}</td>
                                    <td>{{ride[1]}}</td>
                                    <td>{{ride[2]}}</td>
                                    <td>{{ride[3]}}</td>
                                    <td>{{ride[4]}}</td>
                                    <td>{{ride[5]}}</td>
                                    <td>{{ride[6]}}</td>
                                    <td>{{ride[7]}}</td>
                                    <td>{{ride[8]}}</td>
                                    <td><button class="reservar btn btn-primary text-white" id="{{ride[0]}}">reservar</button></td>
                                </tr>
                            {% endif %}
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </body>
    <!--DataTable Creation Script // Details-->
    <!-- <script type="text/javascript" src="{{url_for('static', filename='javascript/script.js')}}"></script> -->
    <script>

        $(document).ready(function() {
   
   $('#tabela').DataTable({
           language: {
               searchPanes: {
                   clearMessage: 'Delete',
                   collapse: {0: 'Search Options', _: 'Search Options (%d)'}
   
               }
           },
           responsive:{
               details: {
                   display:  $.fn.dataTable.Responsive.display.modal({
                       // Headers: function (row){
                       //     var data = row.data();
                       //     return 'Detalhes de '+ data[0] ;//+ '' + data[1];
                       // }
                       
                   }),
                   renderer: $.fn.dataTable.Responsive.renderer.tableAll()
               }
           } , 
           buttons: [      
               'searchPanes'
           ],
           columnDefs: [
               {
                   target: 0,
                   visible: false,
               }],
           dom: 'Bfrtip',
           
           select: true,
           
           
       });
        
           $(".reservar").click(function(e){
               e.preventDefault();
   
               let DadosReserva={
                   id: $(this).attr("id"),
                   action: "reservar"
               }
               console.log(DadosReserva);
               $.ajax({
                   url: '/reserva',
                   type: 'POST',
                   data: DadosReserva,
                   async: false,
                   success: function(data){
                       alert(data.message);
                       if(data.status===201){
                           alert("Parabens sabes Registar")
                       }
                       else
                       {
                           alert("Erro")
                       }
                       console.log(data.message)
                       window.location.reload()
                   },
                   error: function(data){
                       alert(data);
                   }
               })
           })
          
   });
   
   //https://datatables.net/examples/ajax/null_data_source.html
   //https://datatables.net/examples/api/select_single_row.html
   //https://datatables.net/extensions/select/examples/api/events.html
    </script>
      
</html>



<!--https://datatables.net/extensions/fixedcolumns/examples/styling/col_filter.html-->
<!--https://datatables.net/extensions/searchpanes/examples/advanced/columnFilter.html-->