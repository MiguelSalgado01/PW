<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <script
                src="https://kit.fontawesome.com/86102a7658.js"
                crossorigin="anonymous"
        ></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
        <script
                src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
                integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
                crossorigin="anonymous"
        ></script>
        <script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"></script>
        <script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-pie.min.js"></script>
        <script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-base.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
        <link rel="stylesheet" href="{{url_for('static', filename='css/home.css')}}"> 
        <title>Home</title>
    </head>
    <body>
        {{frontHomeForm.hidden_tag()}}
        <header class="bg-primary px-2">
            <button class="btn btn-secondary my-3" id="menu-btn">
                <i class="fas fa-bars"></i>
            </button>
        </header>
        <form method="POST">
            <nav class="navbar navbar-expand d-flex flex-column align-item-start bg-dark my-container" id="sidebar" style="padding-top: 0%; height: 95%;z-index: 1;">
                <div href="#" class="navbar-brand text-light w-75">
                    <div class="row justify-content-center align-items-center ">
                        <div class="row">
                            <img
                                    src="https://cdn-icons-png.flaticon.com/512/147/147142.png"
                                    class="rounded"
                                    alt="avatar"
                            />
                        </div>
                        <div class="row mt-3">
                            <h4 class="px-3">{{activeUser.name}}</h4>
                            <h5 class="px-3">{{activeUser.student_number}}</h5>
                        </div>
                        <div class="px-3" style="z-index: 1;">
                            {{frontHomeForm.verPerfil(class="btn btn-primary btn-sm w-100", id="verProf")}}
                        </div>
                    </div>
                </div>
                <ul class="position-absolute navbar-nav d-flex flex-column w-100" style="top: 45%;">
                    <li class="row nav-item px-3" style="padding-top: 15%;">
                        <div class="col-9 text-light">
                            <h5>{{frontHomeForm.criarBoleia.label()}}</h5>
                        </div> 
                        <div class="col-3"  style="cursor:pointer">
                            {{frontHomeForm.hidden_tag()}}
                            <button class="fa-solid fa-arrow-right text-light" type="submit" name="criarBoleia" value="criarRide" style=" background-color: transparent; border: none;"></button>
                        </div>
                    </li>
                    <li class="row nav-item px-3" style="padding-top: 5%;">
                        <div class="col-9 text-light">
                            <h5>{{frontHomeForm.pesquisar.label()}}</h5>
                        </div>
                        <div class="col-3" style="cursor:pointer">
                            {{frontHomeForm.hidden_tag()}}
                            <button class="fa-solid fa-arrow-right text-light" type="submit" name="pesquisar" value="searchRide" style=" background-color: transparent; border: none;"></button>
                        </div>
                    </li>
                    <li class="row nav-item px-3" style="padding-top: 5%;">
                        <div class="col-9 text-light">
                            <h5>{{frontHomeForm.reservas.label()}}</h5>
                        </div>
                        <div class="col-3"  style="cursor:pointer">
                            {{frontHomeForm.hidden_tag()}}
                            <button class="fa-solid fa-arrow-right text-light" type="submit" name="reservas" value="reserveRide" style=" background-color: transparent; border: none;"></button>
                        </div>
                    </li>
                    <li class="row nav-item px-3" style="padding-top: 5%;">
                        <div class="col-9 text-light">
                            <h5>{{frontHomeForm.minhasBoleias.label()}}</h5>
                        </div>
                        <div class="col-3"  style="cursor:pointer">
                            {{frontHomeForm.hidden_tag()}}
                            <button class="fa-solid fa-arrow-right text-light" type="submit" name="minhasBoleias" value="reserveRide" style=" background-color: transparent; border: none;"></button>
                        </div>
                    </li>
                </ul>
                <div class="position-absolute start-50 translate-middle" style="bottom: 2%;">
                    {{frontHomeForm.endSession(class="col-12 d-flex justify-content-center btn btn-primary", id="endSessionBtn")}}
                </div>
            </nav>
            <div class="container position-absolute" style="top: 10%; height: 75%;">
                <div class="row justify-content-center" >
                    <div class="col-9">
                        <h2  class="text-center">Reserva</h2> 
                        {% for reserva in frontReservations %}
                            <div class="container bg-light border border-dark p-1 my-2 rounded-2">
                                <div class="row align-items-center">
                                    <div class="col-10 text-start">
                                        <h7> Dia: {{reserva.Ride.ride_date}}, as: {{reserva.Ride.ride_scheduled_time}}, Condutor: {{reserva.User.name}}</h7>
                                    </div>
                                    <div class="col-2 ">
                                        <a style="cursor:pointer" onclick="">
                                            <button type="button" class="btn btn-primary fa fa-arrow-right text-black" data-bs-toggle="modal" data-bs-target="#exampleModal" style=" background-color: transparent; border: none; padding-left: 10%;">
                                            </button>
                                            
                                            <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                <div class="modal-dialog">
                                                    <div class="modal-content">
                                                        <div class="modal-header">
                                                            <h1 class="modal-title fs-5" id="exampleModalLabel">Reserva</h1>
                                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                                        </div>
                                                        <div class="modal-body"> 
                                                            <ul>Condutor: {{reserva.User.name}}</ul>
                                                            <ul>Veiculo: {{reserva.Vehicle.license_plate}}</ul>
                                                            <ul>Dia: {{reserva.Ride.ride_date}}</ul>
                                                            <ul>Hora: {{reserva.Ride.ride_scheduled_time}}</ul> 
                                                            <ul>Origem: {{reserva.Ride.local_origin}}</ul>  
                                                            <ul>Destino: {{reserva.Ride.local_destiny}}</ul> 
                                                            <ul>Estado: {{reserva.ReservationState.state}}</ul>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="position-absolute start-50 translate-middle" style="top:70%; width: 75%">
                <h4 class="text-center my-2">Boleias Dadas vs Reservas Feitas</h4>
                <canvas id="myChart"></canvas>
            </div>
        </form>
    </body> 
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script type=text/javascript>
        dadosGrafico = {{ frontReservationCount | tojson }};

        console.log(dadosGrafico)
        console.log(dadosGrafico[0][1])

        const ctx = document.getElementById('myChart');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: [dadosGrafico[0][1],dadosGrafico[1][1]],
                datasets: [{
                    label: '# of Votes',
                    data: [dadosGrafico[0][0],dadosGrafico[1][0]],
                    backgroundColor: [
                        'rgb(17,117,124)',
                        'rgb(70,300,227)'
                    ],
                    borderWidth: 0
                }]
            },
        });
    </script>

    <script>
        var menu_btn = document.querySelector("#menu-btn")
        var sidebar = document.querySelector("#sidebar")
        var containerSideBar = document.querySelector(".my-container")
        menu_btn.addEventListener("click", () => {
            sidebar.classList.toggle("active-nav")
            containerSideBar.classList.toggle("active-cont")
        })
    </script>
</html>